<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Self-Supervised Pseudo-Labeling</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.7.4/dist/tf.min.js"></script>
    <script src="https://unpkg.com/ml5@0.12.2/dist/ml5.min.js"></script>
    <link rel="stylesheet" href="style.css" />
    <script src="script.js" defer></script>
</head>
<body>
    <div class="heading">
        <h1>Self-Supervised Learning - Machine-Generated Labels</h1>
        <p>
            Instead of a person providing labels, we rely on a pre-trained MobileNet to describe each image on its own.
            The network has learned rich features elsewhere, so here it bootstraps <b>pseudo-labels</b> for any photo you feed it.
            Try your own images or grab the defaults, then ask the model to assign its top categories.
        </p>
        <br>
        <h2 class="flash-warning"><i>No human annotations required | watch the machine narrate the data.</i></h2>
    </div>
    <br>
    <section class="card">
        <h2>1) Load Images</h2>
        <div class="controls">
            <input id="file" type="file" accept="image/*" multiple />
            <button id="btn-clear-images" disabled>Remove All</button>
            <button id="btn-default-images">Use Default Images</button>
        </div>
        <br>
        <p id="imgs-status">No images yet.</p>
        <div id="thumbs" class="thumbs"></div>
    </section>

    <section class="card">
        <h2>2) Let the Network Describe Them</h2>
        <div class="controls">
            <button id="btn-label-random" disabled>Label Random Image</button>
            <button id="btn-label-all" disabled>Label All Images</button>
        </div>

        <p id="status">Loading ml5 and MobileNet</p>

        <div class="preview-row">
            <div class="preview-box">
                <h3>Current Image</h3>
                <canvas id="preview" width="224" height="224"></canvas>
                <p id="curimg">N/A</p>
            </div>
            <div class="results-box">
                <h3>Top Machine Labels</h3>
                <ul id="results"></ul>
            </div>
        </div>
    </section>

    <section class="card">
        <h2>Pseudo-Label Log</h2>
        <p>Each request records the model's best guess so you can export machine-generated annotations later on.</p>
        <ul id="log" class="log"></ul>
    </section>

    <!-- hidden source image element (needed for drawing but not shown) -->
    <img id="img" alt="hidden source" style="display:none" />
</body>
</html>
